# Текущий этап разработки

## Сделано

### Архитектура и модели
- Реализована финальная структура моделей:
  - `User` (buyer / shop)
  - `Shop`
  - `Category`
  - `Product` — эталон товара (уникальный `model`)
  - `ProductInfo` — оффер конкретного магазина (`external_id`, цена, остаток)
  - `Parameter`, `ProductParameter`
  - `Order`
  - `ShopOrder` — подзаказы по магазинам
  - `OrderItem`
  - `Address`
- Заказ разбит на подзаказы (`ShopOrder`) с независимыми статусами
- Разделение ответственности:
  - `Product` — справочник
  - `ProductInfo` — продаваемая позиция магазина

---

### Аутентификация и профиль пользователя
- Регистрация пользователя
- Активация аккаунта по email
- Login (Token + session)
- Logout
- Смена пароля
- Смена email с подтверждением по ссылке
- Профиль клиента (просмотр / редактирование)

---

### Бизнес-логика магазина (seller / shop)
- Импорт каталога из YAML-файла по URL (добвлена асинхронность)
- Управление магазином:
  - название
  - URL
  - статус активности (приём заказов)
  - категории (добавление / удаление)
- Управление товарами магазина:
  - создание офферов
  - обновление цен, остатков и параметров
  - удаление офферов
- Просмотр подзаказов магазина (кроме `basket`)
- Просмотр адреса доставки и состава подзаказа
- Смена статуса подзаказа с контролем допустимых переходов

---

### Бизнес-логика покупателя (buyer)
- Просмотр каталога товаров
- Фильтрация и поиск
- Корзина:
  - добавление товаров
  - удаление товаров
  - автоматическое разбиение по магазинам
- Адреса доставки:
  - создание
  - редактирование
  - удаление
  - строгая логика одного адреса по умолчанию
- Оформление заказа:
  - проверка и списание остатков
  - перевод заказа и подзаказов в рабочие статусы
  - создание новой корзины
- Просмотр списка своих заказов
- Детальный просмотр заказа

---

### Email-уведомления
- Покупателю — подтверждение заказа
- Магазинам — накладные по подзаказам
- Администратору — накладная по заказу
- Реализована защита от user-enumeration
- В dev-окружении используется console backend
- Отправка писем выполнена с помощью Celery

---

### API и инфраструктура
- Переработана структура эндпоинтов
- Реализован гибридный режим аутентификации:
  - SessionAuthentication (DRF UI)
  - TokenAuthentication (API-клиенты)
- Проект покрыт автотестами
- Все тесты проходят (`python manage.py test`)
- Документация API с помощью DRF-Spectacular и Swagger

---

## В процессе
- Подключение реального email backend (SMTP)
- Финальная полировка бизнес-правил статусов заказов
- Документация API (описание эндпоинтов)

---

## Планируется
- Возможное расширение логики отмены заказов
- Дополнительная валидация бизнес-правил
- Опциональный рефакторинг под производственную нагрузку
